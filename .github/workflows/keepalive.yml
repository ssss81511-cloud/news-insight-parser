name: Keep Render Service Alive

on:
  schedule:
    # Runs every 10 minutes (Render free tier sleeps after 15 min of inactivity)
    - cron: '*/10 * * * *'
  workflow_dispatch: # Allows manual trigger from GitHub UI

jobs:
  ping:
    runs-on: ubuntu-latest

    steps:
      - name: Ping Render service
        run: |
          echo "Pinging service at $(date)"

          # Ping the service (replace with your actual Render URL)
          response=$(curl -s -o /dev/null -w "%{http_code}" https://news-insight-parser.onrender.com/)

          echo "Response code: $response"

          if [ $response -eq 200 ] || [ $response -eq 302 ]; then
            echo "✅ Service is alive and responding"
          else
            echo "⚠️ Service returned unexpected code: $response"
          fi

      - name: Keep-alive timestamp
        run: echo "Last ping - $(date -u)"
